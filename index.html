<!doctype html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RoomTwin – Miljøstyring for grupperom</title>
  <style>
    :root{
      --bg:#ffffff;
      --text:#0f172a;
      --muted:#475569;
      --line:#e2e8f0;
      --chip:#f1f5f9;
      --shadow:0 18px 55px rgba(2,6,23,.12);
      --shadow2:0 10px 30px rgba(2,6,23,.10);

      --blue:#2563eb;
      --green:#16a34a;
      --red:#ef4444;
      --amber:#f59e0b;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:var(--bg);
      color:var(--text);
    }

    /* HEADER */
    header{
      position:sticky; top:0; z-index:10;
      border-bottom:1px solid rgba(226,232,240,.75);
      background:rgba(255,255,255,.82);
      backdrop-filter: blur(10px);
    }
    .wrap{max-width:1100px; margin:0 auto; padding:14px 18px}
    .top{
      display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;
    }
    .brand{display:flex; gap:12px; align-items:center}
    .logo{
      width:38px;height:38px;border-radius:12px;
      background:linear-gradient(135deg,var(--blue),var(--green));
      box-shadow:0 12px 28px rgba(37,99,235,.18);
    }
    .brand h1{margin:0; font-size:15px}
    .brand .sub{font-size:12px; color:var(--muted); margin-top:2px}
    nav{display:flex; gap:10px; flex-wrap:wrap}
    a.nav{
      font-size:12px; color:var(--muted); text-decoration:none;
      padding:8px 10px; border-radius:999px;
      border:1px solid var(--line); background:#fff;
    }
    a.nav.active{
      border-color:rgba(37,99,235,.35);
      background:rgba(37,99,235,.06);
      color:var(--text);
      font-weight:900;
    }

    /* HERO */
    main{max-width:1100px; margin:0 auto; padding:18px}
    .hero{
      position:relative;
      border-radius:22px;
      overflow:hidden;
      box-shadow: var(--shadow);
      border:1px solid rgba(226,232,240,.85);
      min-height: 420px;
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      align-items:stretch;
    }
    @media (max-width:900px){
      .hero{grid-template-columns:1fr; min-height:unset}
    }

    /* Background image layer */
    .hero::before{
      content:"";
      position:absolute; inset:0;
      background:
        linear-gradient(90deg, rgba(255,255,255,.92) 0%, rgba(255,255,255,.70) 45%, rgba(255,255,255,.35) 100%),
        url("room-bg.jpg");
      background-size:cover;
      background-position:center;
      filter:saturate(1.05) contrast(1.02);
      transform: scale(1.02);
    }

    /* “Climate-ish” overlay illustration */
    .hero::after{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(700px 320px at 78% 30%, rgba(37,99,235,.14), rgba(37,99,235,0) 70%),
        radial-gradient(540px 260px at 86% 60%, rgba(22,163,74,.12), rgba(22,163,74,0) 72%),
        radial-gradient(420px 220px at 70% 78%, rgba(245,158,11,.10), rgba(245,158,11,0) 70%);
      pointer-events:none;
    }

    .heroInner{
      position:relative;
      padding:22px;
      display:flex;
      flex-direction:column;
      gap:14px;
    }

    .kicker{
      display:inline-flex;
      align-items:center;
      gap:8px;
      background:rgba(241,245,249,.90);
      border:1px solid rgba(226,232,240,.95);
      border-radius:999px;
      padding:7px 10px;
      font-size:12px;
      color:var(--muted);
      width:fit-content;
    }
    .kdot{width:8px;height:8px;border-radius:50%; background:var(--blue)}
    .title{
      margin:0;
      font-size:34px;
      line-height:1.06;
      letter-spacing:-.35px;
      max-width: 18ch;
    }
    .lead{
      margin:0;
      font-size:14px;
      line-height:1.6;
      color:var(--muted);
      max-width: 62ch;
    }

    .actions{
      display:flex; gap:10px; flex-wrap:wrap; margin-top:2px;
    }
    a.btn{
      text-decoration:none;
      font-weight:900;
      color:var(--text);
      background:#fff;
      border:1px solid rgba(226,232,240,.95);
      border-radius:14px;
      padding:11px 13px;
      box-shadow: 0 8px 18px rgba(2,6,23,.07);
      display:inline-flex; align-items:center; gap:10px;
    }
    a.btn.primary{
      border-color:rgba(37,99,235,.35);
      background:rgba(37,99,235,.07);
    }

    /* Right panel */
    .panel{
      position:relative;
      padding:22px;
      display:flex;
      flex-direction:column;
      gap:12px;
      justify-content:center;
    }
    @media (max-width:900px){
      .panel{padding-top:0}
    }

    .glass{
      background: rgba(255,255,255,.86);
      border: 1px solid rgba(226,232,240,.95);
      border-radius: 20px;
      box-shadow: var(--shadow2);
      padding:16px;
      backdrop-filter: blur(10px);
    }

    .panelTop{
      display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;
    }
    .chip{
      background: var(--chip);
      border:1px solid var(--line);
      border-radius:999px;
      padding:6px 10px;
      font-size:12px;
      color:var(--muted);
    }

    /* Gauge */
    .gaugeRow{
      display:flex; gap:14px; align-items:center; flex-wrap:wrap;
      margin-top:12px;
    }
    .gauge{
      --p: 76; /* 0..100 (set by JS) */
      width: 168px;
      height: 168px;
      border-radius: 50%;
      background:
        conic-gradient(
          var(--red) 0%,
          var(--amber) 45%,
          var(--green) 100%
        );
      position:relative;
      box-shadow: 0 10px 25px rgba(2,6,23,.12);
    }
    .gauge::before{
      /* mask ring */
      content:"";
      position:absolute; inset:10px;
      border-radius:50%;
      background:
        conic-gradient(
          rgba(255,255,255,0) 0 calc(var(--p) * 1%),
          rgba(255,255,255,.92) calc(var(--p) * 1%) 100%
        );
      mix-blend-mode: screen;
    }
    .gauge::after{
      /* inner disc */
      content:"";
      position:absolute; inset:18px;
      border-radius:50%;
      background: rgba(255,255,255,.92);
      border:1px solid rgba(226,232,240,.95);
    }
    .gaugeCenter{
      position:absolute; inset:0;
      display:grid;
      place-items:center;
      text-align:center;
      z-index:2;
    }
    .scoreNum{
      font-size:38px;
      font-weight:1000;
      letter-spacing:-.6px;
      line-height:1;
    }
    .scoreLbl{
      margin-top:6px;
      font-size:12px;
      color:var(--muted);
    }

    .insights{
      flex:1;
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap:10px;
      margin-top:10px;
    }
    .mini{
      border:1px solid rgba(226,232,240,.95);
      border-radius:16px;
      padding:12px;
      background: #fff;
    }
    .mini .k{
      font-size:12px; color:var(--muted);
      display:flex; justify-content:space-between; gap:10px;
    }
    .mini .v{
      margin-top:7px;
      font-weight:950;
      font-size:18px;
    }

    .footerLine{
      margin-top:10px;
      font-size:12px;
      color:var(--muted);
      line-height:1.45;
    }

    /* Small “climate icon” */
    .climateBadge{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px;
      border:1px solid rgba(226,232,240,.95);
      border-radius:14px;
      background:rgba(255,255,255,.86);
      box-shadow: 0 8px 18px rgba(2,6,23,.06);
      width:fit-content;
    }
    .climateIcon{
      width:30px; height:30px; border-radius:12px;
      background: linear-gradient(135deg, rgba(37,99,235,.14), rgba(22,163,74,.14));
      border:1px solid rgba(226,232,240,.95);
      display:grid; place-items:center;
    }
    .climateIcon svg{width:18px; height:18px; opacity:.9}
  </style>
</head>

<body>
<header>
  <div class="wrap">
    <div class="top">
      <div class="brand">
        <div class="logo"></div>
        <div>
          <h1>RoomTwin (proto)</h1>
          <div class="sub">Digital tvilling for miljøstyring i grupperom</div>
        </div>
      </div>

      <nav>
        <a class="nav active" href="index.html">Forside</a>
        <a class="nav" href="user.html">Bruker</a>
        <a class="nav" href="dashboard.html">Dashboard</a>
        <a class="nav" href="twin-live.html">Live tvilling</a>
        <a class="nav" href="feedback.html">Feedback</a>
      </nav>
    </div>
  </div>
</header>

<main>
  <section class="hero">
    <div class="heroInner">
      <div class="kicker"><span class="kdot"></span> NTNU Gløshaugen · Grupperom</div>

      <h2 class="title">Et rom som styrer seg selv.</h2>

      <p class="lead">
        RoomTwin kombinerer sensorer og brukerfeedback for å gi én enkel score og tydelige tiltak:
        bedre luft, riktig temperatur, lavere støy og smartere lys.
      </p>

      <div class="climateBadge" title="Illustrasjon: inneklima">
        <div class="climateIcon" aria-hidden="true">
          <!-- enkel klima-ikon (luft/blad) -->
          <svg viewBox="0 0 24 24" fill="none">
            <path d="M5 12c3.5-1.5 6.5-1.5 10 0" stroke="rgba(37,99,235,.9)" stroke-width="2" stroke-linecap="round"/>
            <path d="M5 16c2.8-1.2 5.6-1.2 8.4 0" stroke="rgba(37,99,235,.7)" stroke-width="2" stroke-linecap="round"/>
            <path d="M14 20c4-2 6-6 6-10 0-3-2-5-5-5-4 0-7 3-7 7 0 3 2 6 6 8Z"
                  fill="rgba(22,163,74,.25)" stroke="rgba(22,163,74,.8)" stroke-width="1.5"/>
          </svg>
        </div>
        <div style="font-size:12px; color:var(--muted)">
          <strong style="color:var(--text)">Inneklima</strong> · luft · varme · lys · støy
        </div>
      </div>

      <div class="actions">
        <a class="btn primary" href="user.html">Start som bruker →</a>
        <a class="btn" href="dashboard.html">Åpne dashboard →</a>
        <a class="btn" href="twin-live.html">Se live tvilling →</a>
      </div>

      <div class="footerLine">
        Tips: Velg rom i <strong>Bruker</strong>-siden, så åpnes samme rom automatisk i Dashboard og Live tvilling.
      </div>
    </div>

    <div class="panel">
      <div class="glass">
        <div class="panelTop">
          <strong style="font-size:14px;">Romscore (nå)</strong>
          <span class="chip" id="roomChip">Grupperom 1</span>
        </div>

        <div class="gaugeRow">
          <div class="gauge" id="gauge" style="--p:76;">
            <div class="gaugeCenter">
              <div class="scoreNum" id="scoreNum">76</div>
              <div class="scoreLbl" id="scoreLbl">OK</div>
            </div>
          </div>

          <div style="flex:1; min-width:180px">
            <div style="font-weight:950; margin-bottom:6px;">Hva påvirker scoren?</div>
            <div style="color:var(--muted); font-size:13px; line-height:1.5">
              CO₂, temperatur, lys og støy + brukernes tilbakemeldinger.
              Målet er færre klager og mer stabile rom.
            </div>
          </div>
        </div>

        <div class="insights" style="margin-top:14px">
          <div class="mini">
            <div class="k"><span>CO₂</span><span id="co2K">ppm</span></div>
            <div class="v" id="co2V">880</div>
          </div>
          <div class="mini">
            <div class="k"><span>Temp</span><span id="tempK">°C</span></div>
            <div class="v" id="tempV">22.2</div>
          </div>
          <div class="mini">
            <div class="k"><span>Støy</span><span id="noiseK">dBA</span></div>
            <div class="v" id="noiseV">54</div>
          </div>
          <div class="mini">
            <div class="k"><span>Lys</span><span id="luxK">lux</span></div>
            <div class="v" id="luxV">520</div>
          </div>
        </div>

        <div class="footerLine" style="margin-top:12px">
          Oppdatert: <strong id="updatedAt">nå</strong> · (demo)
        </div>
      </div>
    </div>
  </section>
</main>

<script>
  // Sørg for at appen alltid har et valgt rom
  if(!localStorage.getItem("roomtwin_selected_room")){
    localStorage.setItem("roomtwin_selected_room","r1");
  }

  const roomMap = {
    r1:{ name:"Grupperom 1", s:{ co2:880, temp:22.2, noise:54, lux:520 }, baseStars:4.4 },
    r2:{ name:"Grupperom 2", s:{ co2:1040, temp:21.0, noise:60, lux:340 }, baseStars:3.6 },
    r3:{ name:"Grupperom 3", s:{ co2:1160, temp:22.8, noise:66, lux:260 }, baseStars:3.0 },
    r4:{ name:"Grupperom 4", s:{ co2:920, temp:23.6, noise:57, lux:610 }, baseStars:4.1 }
  };

  const clamp=(v,min,max)=>Math.max(min,Math.min(max,v));

  function sensorScore(s){
    let score=100;
    if(s.co2>1200) score-=30; else if(s.co2>1000) score-=18; else if(s.co2>900) score-=8;
    if(s.temp<20 || s.temp>24.5) score-=18; else if(s.temp<20.5 || s.temp>23.5) score-=8;
    if(s.noise>65) score-=22; else if(s.noise>55) score-=10;
    if(s.lux<250) score-=10; else if(s.lux<300) score-=5;
    return clamp(Math.round(score), 0, 100);
  }

  function totalScore(room){
    const sScore = sensorScore(room.s);
    const fScore = clamp(Math.round((room.baseStars/5)*100), 0, 100);
    return clamp(Math.round(0.65*sScore + 0.35*fScore), 0, 100);
  }

  function labelFor(score){
    if(score>=80) return "Anbefalt";
    if(score>=65) return "OK";
    return "Varsel";
  }

  function timeNow(){
    return new Date().toLocaleTimeString([], {hour:"2-digit", minute:"2-digit"});
  }

  function render(){
    const selected = localStorage.getItem("roomtwin_selected_room") || "r1";
    const room = roomMap[selected] || roomMap.r1;

    // små “levende” variasjoner (demo)
    const s = {
      co2: clamp(room.s.co2 + (Math.random()*40 - 12), 420, 1800),
      temp: clamp(Math.round((room.s.temp + (Math.random()*0.2 - 0.05))*10)/10, 18, 27),
      noise: clamp(room.s.noise + (Math.random()*4 - 1.5), 35, 85),
      lux: clamp(room.s.lux + (Math.random()*80 - 20), 80, 1200),
    };

    const score = totalScore({ ...room, s });

    document.getElementById("roomChip").textContent = room.name;
    document.getElementById("scoreNum").textContent = score;
    document.getElementById("scoreLbl").textContent = labelFor(score);
    document.getElementById("gauge").style.setProperty("--p", score);

    document.getElementById("co2V").textContent = Math.round(s.co2);
    document.getElementById("tempV").textContent = s.temp.toFixed(1);
    document.getElementById("noiseV").textContent = Math.round(s.noise);
    document.getElementById("luxV").textContent = Math.round(s.lux);

    document.getElementById("updatedAt").textContent = timeNow();
  }

  render();
  setInterval(render, 5000);
</script>
</body>
</html>